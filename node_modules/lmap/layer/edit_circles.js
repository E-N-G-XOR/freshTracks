"use strict";var i=require("./../map/map"),e=require("bcore/event"),t=require("bcore/utils"),n=require("./edit_circle"),r=require("./../leaflet"),d=e.extend({options:{},initialize:function(i){i=this.options=t.deepMerge(this.options,i)},addTo:function(i){this._map=i},addCircle:function(i){var e=this._map,t=1e3,r=new n(i,t,{id:null}).addTo(e);this.initEventsCircle(r)},render:function(i){var e,t,r,d,l,s=this.circles=[],a=this._map;for(var o in i)e=i[o],r=e.id,d=e.center,l=e.radius,t=s[r]=new n([d.lat,d.lng],l,{id:r}).addTo(a),this.initEventsCircle(t)},initEventsCircle:function(i){var e=this;i.on("upload",function(){var t=this._latlng,n=this.getRadius(),r={type:"circle",unit:"m",lat:t.lat,lng:t.lng,radius:n},d={query:r,circle:i};return this.id?(r.id=this.id,e.emit("modify",d)):void e.emit("create",d)}).on("delete",function(){this._onDeleteCallback(),null!==this.id&&void 0!==this.id&&e.emit("delete",{id:this.id})})}});r.dmap=r.dmap||{},r.dmap.editCircles=function(i){return new d(i)},module.exports=d;