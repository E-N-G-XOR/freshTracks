"use strict";function e(e,n,t){var r;return E(e)?r=e:e=C(e),t?r?'<a href="'+r+'">点击查看</a><br>':"<div>"+e+"</div><br>":r?'<div style="'+q+'">              <div style="'+q+'">'+n+': </div>              <a target="_Blank" style="'+L+'" href="'+r+'">『点击查看』</a>            </div><br>':'<div style="'+q+'">            <div style="'+q+'">'+n+': </div>            <a style="'+L+'">'+e+"</a>          </div><br>"}function n(e,n,t){n=n||"#0cc",t=t||"#bbb";var r,i,o="",a="display:inline-block;white-space:nowrap;",u=a+"color:"+t+";margin-right:5px;",f=a+"color:"+n+";font-weight:normal";if(Array.isArray(e))e.forEach(function(e){"string"==typeof e&&(i='<a style="'+f+'">'+e+"</a><br>",o+=i)});else if("object"===("undefined"==typeof e?"undefined":g(e)))for(var l in e){var r=e[l];"string"==typeof r&&(i='<a style="'+u+'">'+l+': </a><a style="'+f+'">'+r+"</a><br>",o+=i)}return o}function t(n,t){var r="array"==typeof n,i=void 0,o="";for(var a in n)i=n[a],"object"!==("undefined"==typeof i?"undefined":g(i))&&("number"==typeof i&&(i=w.numberFormater(i,2)),o+=e(i,a,r,t));return o}function r(e,n){return function(r){var i={};for(var o in e){var a=e[o];a in r&&(i[a]=r[a])}return t(i,n)}}function i(e){return function(n,r){var i=void 0,o=void 0,a=void 0;n&&r&&n.properties?(i=n,a=i.properties,o=r):o=n;var u={},f=void 0;return M.forEach(e,function(e,n){a&&(f=a[e]),o&&(f=o[e]||f),u[n]=f}),t(j(u))}}function o(e){return"object"===g(e[0])?!1:!0}function a(e){return void 0===e}function u(e,n){n=n||{};return e.forEach(function(e){if(o(e)){var t=e[0],r=e[1];n.latMax=Math.max(n.latMax||r,r),n.lngMax=Math.max(n.lngMax||t,t),n.latMin=Math.min(n.latMin||r,r),n.lngMin=Math.min(n.lngMin||t,t)}else u(e,n)}),n}function f(e){var n={};return e.forEach(function(e){var t=e.geometry.coordinates,r=u(t);n.latMax=Math.max(n.latMax||r.latMax,r.latMax),n.lngMax=Math.max(n.lngMax||r.lngMax,r.lngMax),n.latMin=Math.min(n.latMin||r.latMin,r.latMin),n.lngMin=Math.min(n.lngMin||r.lngMin,r.lngMin)}),n}function l(e){if(e.features)return f(e.features);if(e.type&&"feature"===e.type.toLowerCase()){var n=e.geometry;if(!n)return;var t=n.coordinates;if(!t)return;return u(t)}}function p(e,n){n=n||[];return e.forEach(function(e){if(o(e)){var t=(e[0],e[1]);(void 0===n[0]||null===n[0])&&(n=e),t>n[1]&&(n[0]=e[0],n[1]=e[1])}else n=p(e,n)}),n}function c(e){var n=p(e.map(function(e){return p(e.geometry.coordinates)}));return n}function s(e){if(e.features)return c(e.features);if(e.type&&"feature"===e.type.toLowerCase()){var n=e.geometry;if(!n)return;var t=n.coordinates;if(!t)return;return p(t)}return p(e)}function d(e,n,t,r){var i="undefined"==typeof e?"undefined":g(e);if("function"===i){var o=e(t,r);return"string"==typeof o||"number"==typeof o?n.innerHTML=o:o}if("string"===i||"number"===i)return n.innerHTML=e;if("object"===i){var a=new m(n,e);return a.render(t),a}}function y(e){if(e){var n=e.parent,t=e.child,r=e.map,i=e.datas,o=e.popup;if(!r)return console.log("map  缺少...");if(!i)return console.log("datas 缺少...");if(o){var a=o.eventType||"click",u=i[0],f=i[1];t.off(a).on(a,function(e){var i=t.popupPosition||e.latlng;r.openPopup(l,i);var l=r._popup;if(o){var p=l._container.getElementsByClassName("leaflet-popup-content")[0],c=t.popupGroup=d(o,p,u,f);if(setTimeout(function(){l._updateLayout(),l._updatePosition()}),"object"!==("undefined"==typeof c?"undefined":g(c)))return;c.on(a,function(e){(t.emit||t.fire).bind(t)("popup-"+a,e),(n.emit||n.fire).bind(n)("child-popup-"+a,e)})}})}}}function v(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{position:"absolute",left:"0%",top:"0%"},e=b.getContainer(e),t=document.createElement("div");return Object.assign(t.style,{width:"100%",height:"100%"}),Object.assign(e.style,n),e.appendChild(t),t}var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m=require("./../plugins/popup"),b=require("bcore/utils"),M=require("lodash"),h=require("./../leaflet"),x=require("./eventTypes"),w=require("./basic"),j=w.cleanObjectNull,E=w.isURL,C=w.pretty,q="margin-right:5px; color:#999;white-space:nowrap; display:inline-block;",L="white-space:nowrap;color:#fff;display:inline-block;font-weight:bold;text-decoration:none;";module.exports={getTopPoint:s,getBBox:l,parseContent:n,initEventsPopup:y,createContainer:v,genPopupObject:i,popupFromObject:t};